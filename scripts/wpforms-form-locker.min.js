const WPFormsFormLocker=window.WPFormsFormLocker||function(e,m){const f={cache:{},init(){m(f.ready)},ready(){f.validation(),f.initNameGroupsValidation(),e.onwpformsRepeaterFieldCloneCreated=function(){f.initNameGroupsValidation()}},validation(){void 0!==m.fn.validate&&m.validator.addMethod("unique",function(i,n,e,o){o="string"==typeof o&&o||"unique";var a=m(n);const r=a.closest(".wpforms-field"),d=this.previousValue(n,o),l=a.closest(".wpforms-form").data("formid"),u=r.data("field-id");let c,s;var t={action:"wpforms_form_locker_unique_answer",form_id:l,field_id:u},a=(s=n.name,r.hasClass("wpforms-field-name")?(i=f.getCombinedValue(r),s="wpforms[fields]["+t.field_id+"]"):a.hasClass("wpforms-smart-phone-field")&&(s="wpforms[fields]["+t.field_id+"]",i=a.siblings('[name="'+s+'"]').first().val()),t[s]=i,this.settings.messages[n.name]||(this.settings.messages[n.name]={}),d.originalMessage=d.originalMessage||this.settings.messages[n.name][o],this.settings.messages[n.name][o]=d.message,m.param(m.extend({data:i},(e="string"==typeof e?{url:e}:e).data)));return null!==d.valid&&d.old===a?d.valid:(d.old=a,d.valid=null,c=this,f.cache[l]=f.cache[l]||{},f.cache[l][u]=f.cache[l][u]||{},!(Object.prototype.hasOwnProperty.call(f.cache,l)&&Object.prototype.hasOwnProperty.call(f.cache[l],u)&&f.cache[l][u].nonUniqueValues&&f.cache[l][u].nonUniqueValues.includes(i))&&(this.startRequest(n),m.ajax(m.extend(!0,{url:wpforms_form_locker.ajaxurl,type:"post",mode:"abort",port:"validate"+n.name,dataType:"json",context:c.currentForm,data:t,success(e){var a,s=!0===e||"true"===e,t=n.name.replace(/(\[[a-z]*\])$/g,"");f.cache[l][u].nonUniqueValues=f.cache[l][u].nonUniqueValues||[],c.settings.messages[n.name][o]=d.originalMessage,s?(a=c.formSubmitted,c.resetInternals(),c.toHide=c.errorsFor(n),c.formSubmitted=a,(c=f.updateValidatorLists(c,t,r,s)).showErrors()):(a={},e=e||c.defaultMessage(n,{method:o,parameters:i}),a[n.name]=d.message=e,(c=f.updateValidatorLists(c,t,r,s)).showErrors(a),f.cache[l][u].nonUniqueValues.includes(i)||f.cache[l][u].nonUniqueValues.push(i)),d.valid=s,c.stopRequest(n,s)}},e)),"pending"))},wpforms_settings.val_unique)},initNameGroupsValidation(){m(".wpforms-validate").each(function(){var e=m(this),a=e.data("validator");m.extend(a.groups,f.getNameGroups(e))})},getCombinedValue(e){const a=[];return e.find("input[data-rule-unique]").each(function(){var e=m(this).val();wpforms.empty(e)||a.push(e)}),a.join(" ")},getNameGroups(e){const i={};return e.find(".wpforms-field.wpforms-field-name.wpforms-field-unique").each(function(){const s=m(this),t=s.attr("id").replace("-container","")+"-field-group";m.each(["first","middle","last"],function(e,a){a=s.find(".wpforms-field-name-"+a).attr("name")||!1;a&&(i[a]=t)})}),i},updateValidatorLists(a,s,t,i){return m.each(a.invalid,function(e){e.indexOf(s)<0||(a.invalid[e]=!i,e=t.find('input[name="'+e+'"]'),i&&a.successList.push(e[0]))}),a}};return f}(document,(window,jQuery));WPFormsFormLocker.init();